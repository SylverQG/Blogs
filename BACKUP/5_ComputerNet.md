# [ComputerNet](https://github.com/SylverQG/Blogs/issues/5)

# 一、概述
1. 计算机性能
   1. 速率（比特每秒bit/s）：比特（bit）：信息论中**信息量的单位**；网络技术中**速率**指的是**数据的传送速率**也称为**数据率**或**比特率**
   2. 带宽（两种不同意义）：
      1. 频域称谓，指信号具有的频带宽度，单位Hz
      2. 时域称谓，表示在单位时间内网络中某信道所能通过的“最高数据率”，单位比特每秒（bit/s）；两者本质一样，一条通信链路的“带宽”越宽，传输的“最高数据率”自然越高
   3. 吞吐量：单位时间内通过某个网络（或信道、接口）的实际数据量。受网络的带宽或网络的额定速率的限制
   4. 时延：时延是指数据（一个报文或分组，甚至是比特）从网络（或链路）的一端传送到另一端所需的时间，有时也成为延迟或迟延
- 发送时延（传输时延）：主机或路由器发送数据帧所需要的时间
```math
   发送时延=\frac{数据帧长度(b)}{发送速率(b/s)}
```
- 传播时延：电磁波在信道中传播一定的距离需要花费的时间
```math
   传输时延=\frac{信道长度(m)}{电磁波在信道上的传播率(m/s)}
```
- 处理时延：主机或路由器在收到分组时需要花费一定的时间进行处理
- 排队时延：结点缓存队列中分组排队所经历的时延（取决于网络当时的通信量）；数据在网络中经历的总时延就是以上四种时延之和
- 注：对于高速网络，提高的仅仅是数据的发送率不是比特在链路上的传播速率
   5. 时延带宽积： $时延带宽积（体积）= 传播时延（长）\times 带宽（截面积）$，以比特为单位的链路长度
   6. 往返时间（RTT）：简单来说，就是两倍传播时延（实际上还包括处理时延，排队时延，转发时的发送时延）
   7. 利用率：信道利用率 $\rightarrow$ 网络利用率（全网络的信道利用率的加权平均值） $D=\frac{D_0}{1-U}, D_0$表示网络空间时的延时， $D_0$表示网络空闲时时延， $U$为利用率， $D$表示网络当前的时延；可见信道利用率并不是越高越好，当某信道的利用率增大时，该信道引起的时延也就迅速增大。 减少方法是增大线路的带宽
2. 计算机网络体系结构
   1. OSI/RM：开放系统互联参考模型（法律上的国际标准）：简称`OSI`
   2. TCP/IP：事实上的国际标准
   3. 协议：为进行网络中的数据交换而建立的规则、标准或约定。三要素：语法（结构和格式），语义（动作），同步（顺序）
   4. 分层的好处
      1. 各层之间是独立的
      2. 灵活性好
      3. 结构上可分割开
      4. 易实现和维护
      5. 能促进标准化工作
   5. 五层体系结构
      1. 应用层：通过应用进程（正在运行的程序）间的交互来完成特定网络应用。（如DNS，HTTP，SMTP，FTP）
      2. 运输层：负责向两台主机中进程之间的通信提供的数据传输服务。（复用和分用）
         1. 传输控制协议TCP：提供面向连接的、可靠的数据传输服务，其数据传输单位是报文段
         2. 用户数据报协议UDP：提供无连接的、尽最大努力的数据传输服务（不保证可靠性），其数据传输单位是用户数据报
      3. 网络层：负责为分组交换网上的不同主机提供通信服务（TCP/IP体系中，分组也叫IP数据报）
      4. 数据链路层：将网络层交下来的IP数据报组装成帧，在两个相邻结点（主机和路由器之间或路由器之间）间的链路上传送帧；每一帧包括数据和必要的控制信息
      5. 物理层：透明地传送比特流（双绞线、同轴电缆、光缆、无线信道等不在物理层）
3. 词语
   1. 实体：任何可发送或接受信息的硬件或软件进程
   2. 协议：控制两个对等实体（或多个实体）进行通信的规则的集合。（水平的）
   3. 在协议控制下，两个对等实体间的通信使得本层能够向上一层提供服务（垂直的）要实现本层协议，还需要使用下面一层所提供的服务
   4. 同一系统相邻两层的实体进行交互（即交换信息）的地方，称为服务访问SAP

# 二、物理层
1. 基本概念
   - 机械特性（接口）
   - 电气特性（电压范围）
   - 功能特性（电压的意义）
   - 过程特征（顺序）
2. 数据通信系统
   一个数据通信系统可划分为三大部分，即源系统（发送端、发送方） $\rightarrow$ 传输系统（传输网络） $\rightarrow$ 目的系统（接收端、接收方）
   - 数据（data）：运送消息的实体
   - 信号（signal）：数据的电气的或电磁的表现
   - 模拟信号或连续信号（analogous）：代表消息的参数的取值是连续的
   - 数字信号或离散信号（digital）：代表消息的参数的取值是离散的
   - 码元（code）：代表不同离散数值的基本波形
3. 信道的基本概念
   信道用来表示向某个方向传送信息的媒体；可以有以下三种基本方式
   1. 单向通信（单工通信）：只能有一个方向的通信而没有反方向的交互（广播）
   2. 双向交替通信（半双工通信）：通信的双方都可以发送信息，但不能双方同时发送（当然也就不能同时接收）这种通信方式是一方发送另一方接收，过一段时间后，可以再反过来
   3. 双向同时通信（全双工通信）：通信的双方可以同时发送和接收信息
4. 信道的极限容量
   1. 信道能够通过的频率范围（码间串扰）：加宽频带
   2. 信噪比：信号的平均功率的噪声的平均功率之比；常记为 $S/N$，并用分贝(dB)作为度量单位。即： $信噪比(dB)=10\log_{10} (S/N)(dB)$
   3. 香农公式：信道的极限信息传输速率 $C=W\log_{2}(1+S/N) (bit/s)$;式中W为信道的带宽（单位Hz），S为信道内所传信号的平均功率，N为信道内部的高斯噪声功率
   4. 香农公式表明：信道的带宽或信道中的信噪比越大，信息的极限传输速率就越高。只要信息传输速率低于信道的极限传输速率，就一定存在某种方法实现无差错传输

---

# 三、数据链路层
（计算题：1.CRC；2.征用期、最短帧长与时延）
## 要点
1. 两种信道
   1. 点对点信道
   2. 广播信道
2. 链路：从一个结点到相邻结点的一段物理线程（有线或无线），中间没有任何交换结点
3. 数据链路：当需要在一条线路上传送数据时，除了必须有一条物理线路外，还必须由一些必要的通信协议来控制这些数据的传输，把实现这些协议的硬件和软件加到链路上，就构成了数据链路。最常用网络适配器。
4. 帧：协议数据单元
5. 三个基本问题：
   1. 封装成帧：在一段数据前后分别添加首部和尾部进行帧定界（确定帧的界限）
      1. SOH：帧首部，16进制编码01，二进制是00000001
      2. EOT：帧尾部，16禁止编码04，二进制是00000100
   2. 透明传输：解决透明传输问题具体方法：字节填充（或字符填充），发送端的数据链路层在数据中出现控制字符SOH和EOT的前面插入一个转义字符ESC（16进制编码时1B，二进制00011011）
   3. 差错检测：比特在传输过程中可能会产生差错（比特差错）；传输错误的比特占所传输比特总数的比率称为误码率（BER）
   - 循环冗余码CRC：CRC运算就是在数据M的后面添加供差错检测用的n位冗余码
   - n位荣誉码得出方法：用二进制的模2运算进行 $2^n$ 乘M(待传送的数据)的运算，这相当于在M后面添加n个0。得到的(k+n)位的数除以事先商定的长度为(n+1)位的除数P，得到的余数(比除数少一位)作为冗余码，数据加上冗余码在除以除数P，得到的余数为0即为无差错
   - 凡是接收端数据链路层接受的帧均无差错（无比特差错）
   - 传输差错：帧丢失、帧重复、帧失序
6. 点对点协议PPP
目前使用得最广泛的数据链路层协议
   1. 特点
      1. 简单
      2. 封装成帧
      3. 透明性
      4. 多种网络层协议（支持，IP、IPX）
      5. 多种类型链路（串行、并行、同步、异步、高速、低速、电、光、动态、静态）
      6. 差错检测
      7. 检测连接状态
      8. 最大传送单元（MTU）
      9. 网络层地质协商
      10. 数据压缩协商
   2. 不(需要|支持)的功能
      1. 纠错（不可靠传输）
      2. 流量控制（TCP）
      3. 序号（不可靠传输，在无线时可用）
      4. 多点线路（不支持一主对多从）
      5. 半双工或单工链路（只支持双工）
   3. 组成
      1. IP数据报封装到串行链路的方法
      2. 链路控制协议LCP：用来建立、配置和测试数据链路连接
      3. 网络控制协议NCP：其中的每一个协议支持不同的网络层协议
7. 局域网数据链路层
   1. 局域网的拓扑：星形网，环形网，总线网
   2. 静态划分信道：频分复用、时分复用、波分复用、码分复用；动态媒体接入控制又称作多点接入：随机接入、受控接入、如多点线路探询/轮询
   3. 以太网的两个标准：`DIX Ethernet V2`和 `IEEE 802.3`
   4. CSMA/CD（载波监听多点接入/碰撞检测）协议
      1. 以太网采用的措施
         1. 用较为灵活的无连接的工作方式（不进行编号，不要求对方发回确认）
         2. 曼彻斯特编码（一分为二）
      2. 多点接入：总线型网络
      3. 载波监听（检测信道）
      4. 碰撞检测（冲突检测）
      5. 争用期（碰撞窗口）
      6. 最短有效帧长度为64字节
      7. 强化碰撞：认为干扰信号
      8. 帧间最小间隔为 9.6 微秒，相当于 96 比特时间
   5. 以太网的信道利用率
      1. 成功发送一个帧占用信道的时间 T(发送帧需要的时间，由帧长除以发送速率得出) + $\tau$ (单程端到端传播时延)
      2. 参数 a: $a=\frac{\tau}{T_0}$ a越小越好，以太网的帧长度不能太短
      3. 极限信道利用率 $S_{max}=\frac{1}{1+\alpha}$ 只有当a远小于1才能得到尽可能高的极限信道利用率
8. 要发送的数据为101110。才用CRCD生成多项式是 $P(X)=X^3+1$ 试求应该添加在数据后面的余数
答：作二进制除法，101110 000 10011 添加在数据后面的余数是 011

## 总结
1. 功能：为网络层提供服务、链路管理、帧定界、帧同步与透明传输、流量控制和差错控制
   1. 无确认的无连接服务：如以太网
   2. 有确认的无连接服务：如无线通信
   3. 有确认的面向连接服务：通信要求（可靠性、实时性）较高的场合
   4. 注：有链接就一定要确认
指的是接收方应当能从接收到的二进制比特流中区分出帧的起始和终止

2. 组帧：主要解决帧定界、帧同步与透明传输等问题
   1. 字符技术法：在帧头部使用一个技术字段来表明帧内字符数（此字段也在技术范围内）
   2. 首位定界法：
      1. 概念：使用特定字符或比特模式定界帧的开始和结束
      2. 字符填充：在数据中的特殊字符前面用转义字符（ESC）填充加以区分
      3. 比特填充：使用一个特定的比特模式，即0111110（FLAG）来标志一段帧的开始和结束；容易由硬件来实现，性能好
   3. 违规编码法：信号传输过程中采用违规的编码来表示帧的起始和终止（曼彻斯特编码中，采用高-高或低-低的违规方式来定界帧）
3. 差错控制：分为位错和帧错，主要解决方法由自动重传（ARQ）和前向纠错（FEC）
   1. 噪声：传输中的差错都是噪声引起的
      1. 随机热噪声：信道固有，可提高信噪比来减少或避免干扰
      2. 冲击噪声：来自外界，不可通过提高信号幅度来避免，是产生差错的重要原因
   2. 检错编码
      1. 奇偶校验码：奇校验，由n-1位信息元和一位校验元组成，在附上一个校验元后，码长位n的码字中"1"的个数为奇数。偶校验可以反推。奇偶校验位只能发现奇数个比特的错误
      2. 循环冗余码（CRC）：要会计算
   3. 纠错编码
      1. 海明码、汉明码：能发现双比特的错误，但只能纠正单比特错；（计算海明码）纠错d位，需要码距位2d+1；检错d位，需要码距d+1
4. 流量控制：限制发送方的数据流量，使其发送速率不超过接收方的接收能力
   1. 停止等待协议：发送方每发送一帧都要等待接收方的应答信号才能发送下一帧
   2. 后退N帧协议（GBN）：发送方一次可发送N帧，按顺序接收，重传从最后一个确认开始（即采用累计确认，如若收到对5号帧的确认意味着接收方收到了5号及5号帧前面的帧）
   3. 选择重传（SR）：发送方一次可发送N帧，可以不按顺序接收，重传没有确认的帧
      1. 发送窗口大小>1，接收窗口大小>1
      2. 接收窗口不超过序号范围的一般（避免接收窗口向前移动窗口后，新的窗口与旧窗口产生重叠）
   4. 对于窗口大小为n的滑动窗口，其发送窗口为n-1，即最多可以由n-1帧已发送大没有确认
5. 可靠传输：数据链路层通常使用确认和超时重传两种机制来保证可靠传输
数据链路层中流量控制机制和可靠机制是交织在一起的
6. 介质访问：为使用介质的每个点隔离来自同一信道上其他噶结点所传送的信号，以协调活动节点的传输
   1. 用来决定广播信道中信道分配的协议属于数据链路层的一个子层，称为戒指访问控制（MAC）子层
   2. 信道划分戒指访问控制：
      1. 频分复用FDM：将多路信号调制到不同频率载波上叠加一个不同的信号使用；使用于传输模拟信号
      2. 时分复用TDM：将物理信道按时间分别若干时间片，轮流个不同的信号使用；适用于传输数字信号
      3. 波分复用WDM：在一根光纤中传输多种不同波长（频率）的光信号
      4. 码分复用CDM：靠不同的编码来区分各路原始信号，如CDMA技术
   3. 随机访问介质访问控制：不采用集中控制方式解决发送信息的次序问题，用户随机发送信息，占用信道全部速率
      1. ALOHA协议：
         1. 纯ALOHA：不检测直接发送，若无确认则等待重发
         2. 时隙ALOHA：将时间划分为若干个等长时隙，按时发送
      2. CSMA协议：
         1. 1-坚持：闲则发送，忙则继续监听
         2. 非坚持：闲则发送，忙则等待一个随机时间再监听
         3. p-坚持：闲则以概率p发送，1-p等待下一个时隙；忙则等待一个随机时间再监听
      3. CSMA/CD协议（载波侦听多路访问/碰撞检测）
         1. 流程：先听后发，边听边发，冲突停发，随机重发
         2. 碰撞解决：采用二进制指数退避算法来解决碰撞问题（即在第i(i<10)次碰撞后，站点会在0~2的(i-1)次方之间随机选择一个数M，等待M倍的争用期再发送数据。在达到10此碰撞后，随机数的区间固定在最大值1023上，以后不再增加，如果连续超过16次冲突，则丢弃）
         3. 冲突检测时间（即争用期）是指信号在最远两个端点之间往返传输的时间
            1. 最短帧长等于在争用期时间内发送出的比特数
            2. 只有经过争用期之后没有检测到碰撞，才能肯定这次发送不会发送碰撞
         4. 有线局域网
         5. 半双工通信
      4. CSMA/CS（CA碰撞避免）协议
         1. 基本思想：发送数据前先广播告知其他结点，在某一段时间内不要发送数据，以免出碰撞
         2. 避免碰撞：预约信道、ACK帧、RTS/CTS帧
         3. 避免碰撞：采用二进制指数退避算法来解决碰撞问题
         4. 无线局域网
         5. 轮询访问介质访问控制：令牌传递协议，以循环的方式轮询每个结点，只有得到令牌的机器才能发送数据，其他必须等待。令牌环网适合负载中的环境
7. 局域网：一种典型的广播信道，在一个较小的范围内，就各种计算机等设备通过双绞线等戒指连接
   1. 考虑到局域网信道质量好
      1. 采用无连接的工作方式
      2. 不对发对发送帧编号、确认
   2. 介质访问控制（决定性）（CSMA/CD、令牌总线和令牌环，前两种用于总线型局域网，第三种用于环形局域网）
   3. IEEE802标准定义局域网的参考模型对应于OSI参考模型的数据链路层和物理层，并将数据链路层拆分为两个子层：逻辑链路控制(LLC)子层和媒体接入控制(MAC)子层
      1. 物理层：信号的编码和译码、比特的接收和传承
      2. MAC子层：向上层屏蔽对物理层访问的各种差异，提供对物理层的统一访问接口，功能：组帧和拆卸帧、比特传输差错检测、透明传输、寻址、竞争处理
      3. LLC子层：建立和释放数据链路层的逻辑连接、提供与高层的接口、差错控制、给帧加序号
   4. 较低延时和较低的误码率
   5. 三种局域网拓扑实现
      1. 以太网（Ethernet）：逻辑拓扑是总线型结构，物理拓扑是星形或拓展星形
         1. `10BASE-T`以太网使用曼彻斯特编码
         2. 信息传播方式：广播式
      2. 令牌环：逻辑拓扑是环形结构，物理拓扑是星形结构
         1. 最坏的情况下，一个结点获得令牌的等待时间等于逻辑环上所有其他结点一次获得令牌，并在令牌持有时间内发送数据帧的时间总和
      3. FDDI：逻辑拓扑是环形结构，物理拓扑是双环结构
   6. 网卡：装有处理器和存储器，是工作在数据链路层的网路组件，有唯一代码，称为介质访问控制(MAC)地址
      1. MAC地址是链路层地址，长度为6字节(48位)，用于唯一标识网络适配器(网卡)
      2. 一台主机拥有多少个网络适配器就有多少个MAC地址
8. 虚拟局域网
   1. 虚拟局域网可以建立与物理位置无关的逻辑组，只有在同一个虚拟局域网中的成员才会收到链路层广播消息
9. 广域网
   1. 在OSI参考模型中，广域网数据链路层控制协议
      1. PPP协议
         1. 定义：使用串行线路通信的面向字节（帧全长是整个字节）的协议，应用在直接连接两个结点的链路上
         2. 面向字节，采用字节填充方式，只支持全双工链路
         3. 提供差错检测但不提供差错纠错，保证无差错接收；不可靠，不使用序列号和确认机制
         4. 三个组成部分
            1. 链路控制协议LCP：用于建立、配置、测试和管理数据链路
            2. 网络控制协议NCP：PPP允许采用多种网络协议层，每个不同的网络层要用一个相应的NCP来配置，为网络层协议建立和配置逻辑连接
            3. 一个将IP数据包封装到串行链路的方法
      2. HDLC协议：面向比特，采用0比特插入法，帧类分为信息帧、监督帧和无编号帧，数据操作方式：正常响应方式（从站在收到主站许可后才能）、异步平衡方式（每一个复合站都可以进行对其他站的数据传输）、异步响应方式（从站无需主站许可）
         1. 信息帧：第一位为0，传输数据，或使用捎带奇数对数据进行确认
         2. 监督帧：第1、2位分别位1、0，流量控制和差错控制，确认、请求重发、请求暂停发送
         3. 无编号帧：链路建立、拆除等多种控制功能
10. 设备
    1. 网桥：
       1. 特点：两个或多个以太网通过网桥连接起来变成一个网段
       2. 类型
          1. 透明网桥（选择的不是最佳路由）：按照自学习算法填写转发表，按转发表转发
          2. 源路由器网桥（选择的是最佳路由）：先发送发现帧，按返回结果转发
    2. 交换机：实际是一个多端口网桥，工作在数据链路层，数据链路层使用武力地址进行转发
       1. 特点：把两个或多个以太网通过网桥连接起来变成一个网段
       2. 类型：
          1. 透明网桥（选择的不是最佳路由）：按照自学习算法填写转发表，按转发表转发
          2. 源路由网桥（选择的是最佳路由）：先发送发现帧，按返回结果转发
    3. 交换机：实际是一个多端口网桥，工作在数据链路层，数据链路层使用武力地址进行转发
       1. 特点：实际是一个多端口网桥
       2. 交换机具有自学能力，学习的是交换表的内容，交换表中存储着MAC地址到端口的映射，即插即用设备
       3. 优点：每个端口结点所占用的带宽不会因为端口结点数目的增加而减少，且整个交换机的总带宽会随着端口结点的增加而增加
       4. 利用交换机可以实现虚拟局域网（VLAN），VLAN不仅可以隔离冲突域，也可以隔离广播域
       5. 交换方式
          1. 直通式：帧在接口后只检查目的地址，几乎马上就被传出去
          2. 存储转发：先将接收到的帧缓存到高速缓存器，检查数据正确性
    4. 相同点：按MAC地址转发，都能隔离冲突率，不能隔离广播率
    5. 交换机比集线器提供更好的网络性能的原因是交换机支持多对用户同时通信