# [Crypto](https://github.com/SylverQG/Blogs/issues/3)

现代密码学目录(仅目录)


# 1. 基础
## 1.1 威胁
## 1.2 信息安全模型
## 1.3 密码学基本概念
## 1.4 古典密码

# 2. 流密码
## 2.1 基本概念
## 2.2 线性反馈移位寄存器
## 2.3 线性移位寄存器的一元多项式表达式
## 2.4 m序列的伪随机性
## 2.5 m序列密码的破译
## 2.6 非线性序列

# 3. 分组密码体制
## 3.1 概述
## 3.2 数据加密标准
## 3.3 差分密码分析与线性密码分析
## 3.4 分组密码的运行模式
## 3.5 IDEA
## 3.6 AES|Rijindael
## 3.7 SM4
## 3.8 祖冲之

# 4. 公钥密码
## 4.1 数学知识
## 4.2 基本概念
## 4.3 RSA
## 4.4 背包密码体制
## 4.5 NTRU
## 4.6 椭圆曲线密码体制
## 4.7 SM2椭圆曲线公钥密码加密算法

# 5. 密钥分配与密钥管理
## 5.1 单钥加密体制的密钥分配
## 5.2 公钥加密体制的密钥分配
## 5.3 随机数的产生
## 5.4 秘密分割

# 6. 消息认证与哈希函数
## 6.1 消息认证
## 6.2 哈希函数
## 6.3 MD5
## 6.4 安全哈希算法
## 6.5 HMAC
## 6.6 SM3

# 7. 数字签名和认证协议
## 7.1 基本概念
## 7.2 数字签名标准
## 7.3 其他签名方案
## 7.4 SM2椭圆曲线公钥密码签名算法
## 7.4 认证协议

# 8. 密码协议
## 8.1 基本协议
## 8.2 零知识证明
## 8.3 安全多方计算

# 9. 可证明安全
## 9.1 语义安全的公钥密码体制定义
## 9.2 语义安全的RSA的加密方案
## 9.3 Paillier公钥密码系统
## 9.4 Cramer-Shoup密码系统
## 9.5 RSA-FDH签名方案
## 9.6 BLS短签名方案
## 9.7 基于身份的密码体制

# 10. 网络加密与认证
## 10.1 网络通信加密
## 10.2 Kerberos认证系统
## 10.3 X.509认证业务
## 10.4 PGP

---

# 复习概要
# 一、引言
1. 密钥体制组成
   1. 明文、密文、密钥、加密算法、解密算法
2. 好的密钥体制
   1. 两类计算容易
      1. 已知明文和加密密钥
      2. 已知密文和解密密钥
   2. 一个不能
      1. 不知道解密密钥时，不能由密文推知明文
3. 攻击分析密码体制方法与应对方法
   1. 穷举攻击 $\rightarrow $增大密钥量
   2. 统计分析攻击 $\rightarrow $使得明文与密文的统计特征不一样
   3. 解密变换攻击 $\rightarrow $选择足够复杂的加密算法
4. 攻击的分类
   1. 自然攻击
      1. 自然灾害、电磁辐射、电磁干扰
   2. 人为攻击
      1. 外部攻击
         1. 被动攻击
            1. 内容信息获取(1)
            2. 数据业务流分析(2)
         2. 主动攻击
            1. 伪造(3)
            2. 篡改：内容修改(4)、顺序修改(5)、计时修改(6)
      2. 外部攻击
         1. 发送方否认(7)
         2. 接收方否认(8)
   3. 安全措施
      1. 数据保密:(1)(2)
      2. 消息认证:(3)(4)(5)(6)
      3. 数字签名:(7)(8)和部分的(3)(4)(5)(6)
5. 安全攻击的形式
   1. 中断
   2. 截取
   3. 伪造
   4. 篡改
   5. 重放
6. 密码分析分类
   1. 唯密文攻击：只知道一些密文
   2. 已知明文攻击：知道一些明文密文对
   3. 选择明文攻击：任意明文 $\rightarrow $密文
   4. 选择密文攻击：任意密文 $\rightarrow $明文
   5. 选择文本攻击：任意明文 $\leftrightarrow $任意密文
7. 密码体制分类
   1. 单钥密码体制
      1. 流密码
      2. 分组密码
   2. 双钥密码体制
      1. 加密密钥和解密密钥不同，DF提出，公钥k1与私钥k2
      2. 用户A用自己的私钥 $k_{A_2} $对消息m进行专用变换： $c=D_{k_{A_2}} $，将c给用户B
      3. 用户B验证m使用: $$m=E_{k_{A_1}}(c)=E_{k_{A_1}}(D_{k_{A_2}}) $$
      4. 双钥保密和认证体制
         1. 为了同时实现保密性和准确性，可以采用双重加解密
```mermaid
graph LR;
A(用户A)--m-->DkA2;
DkA2-->EkB1;
EkB1-->DkB2;
DkB2-->EkA1;
EkA1--m-->B(用户B);
DkA2--认证-->EkA1;
EkB1--保密-->DkB2;

``` 

---

# 二、流密码
1. 基本概念
   1. 流密码将明文划分为字符（如单个字母），或其编码的基本单元（如0、1数字）
   2. 流密码强度完全依赖于密钥流生成器生成密钥流的`随机性`和`不可预测性`
   3. 同步流密码：密钥流产生算法与明文、密文无关
   4. 自同步流密码：密钥流产生算法与明文、密文相关
2. n级反馈移位寄存器
   1. GF(2)上的一个n级反馈移位寄存器由n个二元存储器与一个反馈函数 $f(a_1,a_2,…,a_n)$

这个怎么这么丑
```mermaid
graph LR

   a3-->a2
   a2-->a1



   a3-->f
   a2---->f
   a1-->f

   f-->a3

   a1--输出-->e[*]

```
一个三级反馈移位寄存器的状态和输出
| 状态( $a_3,a_2,a_1$) | 输出  |
| :------------------: | :---: |
|        1 0 1         |   1   |
|        1 1 0         |   0   |
|        1 1 1         |   1   |
|        0 1 1         |   1   |
|        1 0 1         |   1   |
|        1 1 0         |   0   |

3. 线性反馈移位寄存器(LFSR)
   1. 性质：完全由其反馈函数决定
   2. n级LFSR的状态最多有 $2^n$个
   3. n级LFSR的状态周期 $\le 2^n -1$
   4. 输出序列的周期=状态周期 $\le 2^n -1$
   5. 选择合适的反馈函数可以使序列达到最大值 $2^n -1$
   6. 周期达到最大值的序列称为`m序列`
   7. LFSR的特征多项式 $p(x)=1+c_1 x+c_2 x+…+c_{n-1}x_{n-1}+c_n x_n$
4. m序列
   1. 介绍在上
   2. 游程：连续的0或1的个数
   3. GF(2)上周期为T的序列 ${a_i}$的自相关函数
      1. 设 ${a_i}$ 满足线性递推关系: $a_{h+n}=c_1a_{h+n-1}\oplus c_2a_{h+n-2} \oplus … \oplus c_n a_h$
   4. m序列的破译

---

5. 例：设敌手获得密文串：101101011110010，
和相应明文串：011001111111001，
相应密钥流：110100100001011，求对应递推关系。
假定敌手还知道密钥流是使用5级线性反馈移位寄存器
解：分别用密文串中前十个比特和明文串中前十个比特建立如下方程

```math
(a_6,a_7,a_8,a_9,a_{10})=(c_5,c_4,c_3,c_2,c_1)
\begin{pmatrix}
a_1 & a_2 & a_3 & a_4 & a_5\\
a_2 & a_3 & a_4 & a_5 & a_6\\
a_3 & a_4 & a_5 & a_6 & a_7\\
a_4 & a_5 & a_6 & a_7 & a_8\\
a_5 & a_6 & a_7 & a_8 & a_9\\
\end{pmatrix}
\tag{1}
```
即：
```math
(0, 1, 0, 0, 0)=(c_5,c_4,c_3,c_2,c_1)
\begin{pmatrix}
1 & 1 & 0 & 1 & 0\\
1 & 0 & 1 & 0 & 0\\
0 & 1 & 0 & 0 & 1\\
1 & 0 & 0 & 1 & 0\\
0 & 0 & 1 & 0 & 0\\
\end{pmatrix}
\tag{2}
```
求矩阵的逆矩阵：
```math
\begin{pmatrix}
1 & 1 & 0 & 1 & 0\\
1 & 0 & 1 & 0 & 0\\
0 & 1 & 0 & 0 & 1\\
1 & 0 & 0 & 1 & 0\\
0 & 0 & 1 & 0 & 0\\
\end{pmatrix}^{-1}
=
\begin{pmatrix}
0 & 1 & 0 & 0 & 1\\
1 & 0 & 0 & 1 & 0\\
0 & 0 & 0 & 0 & 1\\
0 & 1 & 0 & 1 & 1\\
1 & 0 & 1 & 1 & 0\\
\end{pmatrix}
\tag{3}
```
从而
```math
(c_5,c_4,c_3,c_2,c_1)=(0, 1, 0, 0, 0)
\begin{pmatrix}
0 & 1 & 0 & 0 & 1\\
1 & 0 & 0 & 1 & 0\\
0 & 0 & 0 & 0 & 1\\
0 & 1 & 0 & 1 & 1\\
1 & 0 & 1 & 1 & 0\\
\end{pmatrix}
\tag{4}
```
```math
(c_5,c_4,c_3,c_2,c_1)=(1, 0, 0, 1, 0)\tag{5}
```
则密钥流的递推关系为
```math
a_{i+5} = c_5 a_i\oplus c_2a_{i+3} =a_i\oplus a_{i+3}
```

---

# 三、置换密码
1. 置换
   1. 置换密码又叫做换位密码，根据一定的规则重新排列明文，打破明文的结构特性。特点是保持明文所有的字符不变，仅仅打乱明文字符的位置和次序。
2. 常见的置换密码有
   1. 列置换密码：明文遵照密钥的规则按照列换位并且按照列得到密文
   2. 周期置换密码：将明文按照固定的长度进行分组，然后对每组按照某种重新排列得到密文
3. 例：设有限集 $X = \{ 1,2,3,4,5,6,7,8 \}, \sigma$ 为 $X$上的一个置换，并且满足 $\sigma (1)=2, \sigma (2)=5, \sigma (3)=3, \sigma (4)=6, \sigma (5)=1, \sigma (6)=8, \sigma (7)=4, \sigma (8)=7,$ 因为置换可以对换表示，所以上述置换 $\sigma $可以形式化为:
```math
\sigma=\begin{pmatrix}
1 & 2 & 3 & 4 & 5 & 6 & 7 & 8\\
2 & 5 & 3 & 6 & 1 & 8 & 4 & 7
\end{pmatrix}
=
(125)(3)(4687)
=
(125)(4687)
```
则其逆置换 $\sigma ^{-1}$可表示为：
```math
\sigma ^{-1}=\begin{pmatrix}
1 & 2 & 3 & 4 & 5 & 6 & 7 & 8\\
2 & 5 & 3 & 6 & 1 & 8 & 4 & 7
\end{pmatrix}^{-1} \\
=
\begin{pmatrix}
1 & 2 & 3 & 4 & 5 & 6 & 7 & 8\\
5 & 1 & 3 & 7 & 2 & 4 & 8 & 6
\end{pmatrix}
=(152)(3)(4786)=(152)(4786)
```

4. 例：
   - 明文：cryptograph is an applied science
   - 密钥：encry
   - 求密文

```math
\sigma=\begin{pmatrix}
2 & 3 & 1 & 4 & 5\\
c & r & y & p & t\\
o & g & r & a & p\\
h & y & i & s & a\\ 
n & a & p & p & l\\ 
i & e & d & s & c\\
i & e & n & c & e
\end{pmatrix}
=
\begin{pmatrix}
1 & 2 & 3 & 4 & 5\\
y & c & r & p & t\\
r & o & g & a & p\\
i & h & y & s & a\\ 
p & n & a & p & l\\ 
d & i & e & s & c\\
n & i & e & c & e
\end{pmatrix}
```

则 密文： ycrpt rogap ihysa pnapl diesc niece

5. 周期置换密码
   1. 周期置换密码是将明文串P按固定长度m分组，然后对每组中的子串按1,2,…,m的某个置换重排位置从而得到密文C。其中密钥 $\sigma $包含分组长度信息。解密时同样对密文C按照长度m分组，并按照 $\sigma$ 的逆置 $\sigma ^{-1}$把每组子串冲核心排列位置从而得到明文P
   2. 例：
      1. 明文："State key Laboratory of Networking and  Switching";加密密钥： $\sigma = (1\ 5\ 6\ 2\ 3)$
      2. 将明文分为7组：(Statek)(eyLabo)(ratory)(ofNetw)(orking)(andSwi)(tching)
      3. 加密变换：(aKttSe)(Loyaeb)(tyaorr)(Nwfeot)(kgrion)(dinSaw)(hgcitn)
      4. 最终密文：(aKttSeLoyaebtyaorrNwfeotkgriondinSawhgcitn)
      5. 由加密密钥易知解密密钥： $\sigma ^{-1}=(1\ 3\ 2\ 6\ 5)$

---

6. 代换密码
   1. 代换，就是明文中的一个字母由其他字母、数字或者符号替代的一种方法
   2. 代换密码就是建立一个代换表，加密时将需要加密的明文依次通过查表，替换为相应的字符，明文字符被逐个替换后，生成无任何意义的字符串，即密文。这样的代换表被称之为密钥
   3. 代换密码的分类
      1. 依据：按照一个明文字母是否总是被一个固定的字符代换进行划分。
      2. 单表代换：(凯撒、仿射)：对明文消息中出现的同一个字母，在加密时都使用同一固定的字母来代换，不管他在什么地方。
      3. 多表代换：(维吉尼亚、Playfair、转轮)：明文消息中出现的同一个字母，在加密时不是完全被同一固定的字母代换，而是根据其出现的位置次序，用不同的字母代换。
   4. 例：
      ```math
      密钥=\begin{Bmatrix}
      a & b & c & d & e & f & g & h & i & j & k & l & m & n & o & p & q & r & s & t & u & v & w & x & y & z\\
      f & q & i & s & h & n & c & v & j & t & y & a & u & w & d & r & e & x & l & b & m & z & o & g & k & p
      \end{Bmatrix}
      ```
      ```math
      \begin{matrix}
      & to  & be & or & not & to & be\\
      加密 &\downarrow\downarrow & \downarrow\downarrow &\downarrow\downarrow &\downarrow\downarrow\downarrow &\downarrow\downarrow &\downarrow\downarrow\\
      & bd & qh & dx & wdb & bd & qh\\
      解密 &\downarrow\downarrow & \downarrow\downarrow &\downarrow\downarrow &\downarrow\downarrow\downarrow &\downarrow\downarrow &\downarrow\downarrow\\
      & to  & be & or & not & to & be\\
      \end{matrix}
      ```
   5. 仿射密码
      1. 加密： 
      ```math
       e_k(x)=x+k(mod\ 26)=y\in C
       ```
      2. 解密： 
      ```math
      x=d_k(y)=y-k(mod\ 26)
      ```